<!doctype html>
<html>
   <head>
      <title>WMP SVG lab</title>
      <link rel="stylesheet" href="index.css" />
      <link rel="stylesheet" href="gradient-editor.css" />
      <style>
body {
   display: grid;
   gap:     8px;
   
   grid-template:
      "full      raster    padding  "
      "utilities utilities utilities"
      "util-grad util-grad util-grad"
      /
      auto auto 1fr
   ;
}

.pane {
   grid-row: 1;
}
.utilities {
   grid-area: utilities;
}
.utilities.gradient-editor {
   grid-area: util-grad;
}
      </style>
   </head>
   <body>
      
      <!--
         Helper filters for our various tests and viewing options.
         These have to be inside of this file because referencing 
         SVG filters in separate files is broken (probably because 
         I'm running all of this locally and browsers cripple the 
         file:/// origin on purpose).
      -->
      <svg hidden>
         <defs>
            <filter id="filter-disable-alpha">
               <feColorMatrix
                  in="SourceGraphic"
                  type="matrix"
                  values="1 0 0 0 0
                          0 1 0 0 0
                          0 0 1 0 0
                          0 0 0 0 1"
               />
            </filter>
            <filter id="filter-show-alpha">
               <feColorMatrix
                  in="SourceGraphic"
                  type="matrix"
                  values="0 0 0 1 0
                          0 0 0 1 0
                          0 0 0 1 0
                          0 0 0 0 1"
               />
            </filter>
         </defs>
      </svg>
      
      <!--
         Preview areas. While drafting SVGs, I can work directly 
         in here in order to be able to use the DOM inspector on 
         SVG content directly. Once I have a design 90% done, I 
         should move it to its own file.
      -->
      <section class="view play-pause" id="preview">
         <header>
            Controllable preview
         </header>
         <div class="layer raster">
            <img id="raster-preview" width="364" height="102" />
         </div>
         <div class="layer vector">
            <!--
               TODO: Use `color-interpolation: linearrgb` on the 
               other `mask` elements, and adjust their values. 
               In general, masks that are meant to mimic the 
               alpha mask of the source graphics should use 
               linear RGB.
            -->
            <img id="play-pause-button" src="play-pause.svg" style="position:absolute; left: 166px; top: 1px" />
         </div>
         <div class="layer vector">
            <svg name="next" width="104" height="102" viewBox="260 0" style="position: absolute; left: 260px">
               <defs>
                  <style>
                     path.button-shape {
                        d: path("M 4 0 l 79 0 q 15 0 15 23 q 0 23 -15 23 l -78 0 q -3 0 -3 -3 c 0 -9 4 -6 4 -20 c 0 -14 -4 -11 -4 -20 q 0 -3 3 -3 z");
                     }
                  </style>
                  <linearGradient id="next-button-base-color" x1="0" x2="0" y1="0" y2="1">
                     <stop offset="0.00" stop-color="#FFFFFF" />
                     <stop offset="0.30" stop-color="#D8ECFF" />
                     <stop offset="0.45" stop-color="#A8CCF0" />
                     <stop offset="0.50" stop-color="#1c4d8f" />
                     <stop offset="0.68" stop-color="#1c4d8f" />
                     <stop offset="0.76" stop-color="#37A" />
                     <stop offset="0.88" stop-color="#6CE" />
                  </linearGradient>
                  <linearGradient id="next-button-base-alpha" x1="0" x2="0" y1="0" y2="1">
                     <stop offset="0.00" stop-color="#B0B0B0" />
                     <stop offset="0.30" stop-color="#707070" />
                     <stop offset="0.45" stop-color="#666666" />
                     <stop offset="0.50" stop-color="#424242" />
                     <stop offset="0.60" stop-color="#333333" />
                     <stop offset="0.75" stop-color="#2C2C2C" />
                     <stop offset="1.00" stop-color="#303030" />
                  </linearGradient>
                  <linearGradient id="next-button-edge-color" x1="0" x2="1" y1="0" y2="0">
                     <stop offset="0.00" stop-color="#4AF" />
                     <stop offset="0.10" stop-color="#FFFFFF" />
                     <stop offset="0.90" stop-color="#FFFFFF" />
                     <stop offset="1.00" stop-color="#4AF" />
                  </linearGradient>
                  <mask id="next-button-alpha-mask">
                     <rect x="0" y="0" width="100%" height="100%" fill="#000" />
                     <path class="button-shape" fill="url(#next-button-base-alpha)" filter="drop-shadow(0 2px 6px #FFF8)" />
                  </mask>
                  <mask id="next-button-shadow-mask">
                     <rect x="0" y="0" width="100%" height="100%" fill="#000" />
                     <path class="button-shape" fill="#000" stroke="#CCC" stroke-width="2" filter="blur(1px)" />
                  </mask>
               </defs>
               <g mask="url(#next-button-alpha-mask)" transform="translate(0 28)">
                  <path class="button-shape" fill="#00000001" filter="drop-shadow(0 0 4px #00000080)" />
                  <path class="button-shape" fill="url(#next-button-base-color)" filter="drop-shadow(0 0 4px #00000080)" />
               </g>
               <g mask="url(#next-button-shadow-mask)" transform="translate(0 28)">
                  <path class="button-shape" transform="translate(0 1)" fill="#000" stroke-width="4" stroke="#000" />
                  <path class="button-shape" fill="url(#next-button-edge-color)" />
               </g>
            </svg>
         </div>
         <div class="layer vector">
            <svg name="stop" width="70" height="102" style="position: absolute; left: 0px">
               <!--
                  TODO:
                  
                   - Only visible for hover or active
                   
                   - Outline needed
                   
                   - Active: bottom highlight has trapezoidal shape
                   
                   - Hover: bottom highlight has rounded rectangle shape
               -->
               <defs>
                  <linearGradient id="stop-button-color-hover" x1="0" x2="0" y1="0" y2="1">
                     <stop offset="0.090" stop-color="#e5f4f9" />
                     <stop offset="0.098" stop-color="#ecf6fb" />
                     <stop offset="0.275" stop-color="#d0e9f3" />
                     <stop offset="0.475" stop-color="#a4d3e4" />
                     <stop offset="0.475" stop-color="#427eb5" />
                     <stop offset="0.485" stop-color="#3b6da5" />
                     <stop offset="0.55" stop-color="#427ab3" />
                     <stop offset="0.68" stop-color="#42aace" />
                     <stop offset="0.82" stop-color="#4ee3f6" />
                     <stop offset="0.86" stop-color="#69e8f5" />
                     <stop offset="0.88" stop-color="#79f5fd" />
                     <stop offset="0.90" stop-color="#69e8f5" />
                  </linearGradient>
                  <linearGradient id="stop-button-edge-color-hover" x1="0" x2="0" y1="0" y2="1">
                     <stop offset="0.000" stop-color="#FFF" />
                     <stop offset="0.485" stop-color="#f8ffff" />
                     <stop offset="0.50" stop-color="#9397bf" />
                     <stop offset="0.85" stop-color="#a7bfd9" />
                     <stop offset="0.93" stop-color="#d9f6f9" />
                     <stop offset="0.97" stop-color="#FFF" />
                  </linearGradient>
                  
                  <linearGradient id="stop-button-outline-color-hover" x1="0" x2="0" y1="0" y2="1">
                     <stop offset="0.000" stop-color="#004ba1" />
                     <stop offset="0.485" stop-color="#002a7a" />
                     <stop offset="0.95" stop-color="#0d2677" />
                  </linearGradient>
                  <mask id="stop-button-outline-mask">
                     <rect
                        x="0" y="0" width="46" height="46" rx="4"
                        fill="#000"
                        stroke="#FFF"
                        stroke-width="4"
                     />
                     <rect
                        x="0" y="0" width="46" height="46" rx="4"
                        fill="#000"
                     />
                  </mask>
                  
                  <mask id="stop-button-overall-mask" color-interpolation="linearrgb">
                     <defs>
                        <linearGradient id="stop-button-alpha-mask-base" x1="0" x2="0" y1="0" y2="1">
                           <stop offset="0.000" stop-color="#d9d9d9" />
                           <stop offset="0.010" stop-color="#d0d0d0" />
                           <stop offset="0.10" stop-color="#d5d5d5" />
                           <stop offset="0.25" stop-color="#c8c8c8" />
                           <stop offset="0.34" stop-color="#bebebe" />
                           <stop offset="0.41" stop-color="#bababa" />
                           <stop offset="0.45" stop-color="#bdbdbd" />
                           <stop offset="0.51" stop-color="#909090" />
                           <stop offset="0.58" stop-color="#909090" />
                           <stop offset="0.7" stop-color="#989898" />
                        </linearGradient>
                        <radialGradient id="stop-button-alpha-mask-highlight" gradientUnits="objectBoundingBox">
                           <stop offset="0.0" stop-color="#FFFFFFC0" />
                           <stop offset="0.25" stop-color="#FFFFFFA0" />
                           <stop offset="0.75" stop-color="#FFFFFF20" />
                           <stop offset="0.9" stop-color="#FFFFFF00" />
                        </radialGradient>
                        <linearGradient id="stop-button-alpha-mask-edge" x1="0" x2="0" y1="0" y2="1">
                           <stop offset="0.05" stop-color="#e9e9e9" />
                           <stop offset="0.25" stop-color="#d9d9d9" />
                           <stop offset="0.48" stop-color="#cacaca" />
                           <stop offset="0.65" stop-color="#bebebe" />
                           <stop offset="0.90" stop-color="#d0d0d0" />
                           <stop offset="0.98" stop-color="#f9f9f9" />
                        </linearGradient>
                     </defs>
                     <rect
                        x="0" y="2" width="46" height="46" rx="4"
                        fill="#FFFFFFC0"
                        filter="blur(2.5px)"
                     />
                     
                     <rect
                        x="0" y="0" width="46" height="46" rx="4"
                        fill="url(#stop-button-alpha-mask-base)"
                     />
                     <ellipse
                        cx="23" cy="46" rx="30" ry="15"
                        fill="url(#stop-button-alpha-mask-highlight)"
                        clip-path="view-box xywh(0 0 46px 46px round 4px)"
                     />
                     
                     <rect
                        x="0" y="2" width="46" height="42" rx="3"
                        fill="none"
                        stroke="url(#stop-button-alpha-mask-edge)"
                        stroke-width="3"
                        filter="blur(.75px)"
                     />
                  </mask>
               </defs>
               <g transform="translate(6 28)" mask="url(#stop-button-overall-mask)">
                  <rect name="shadow"
                     x="-4" y="0" width="54" height="53" rx="4"
                     fill="#47b5ff"
                  />
               
                  <!--
                     There's no way to get only an inner stroke, so we cover the 
                     outer stroke AND clip-path it to avoid pixels "leaking" out 
                     from under cover.
                  -->
                  <rect
                     x="0" y="0" width="46" height="46" rx="4"
                     fill="url(#stop-button-color-hover)"
                     stroke="url(#stop-button-edge-color-hover)"
                     stroke-width="4"
                     clip-path="fill-box xywh(0 0 100% 100% round 4px)"
                  />
                  
                  <rect
                     x="0" y="0" width="46" height="46" rx="4"
                     mask="url(#stop-button-outline-mask)"
                     fill="url(#stop-button-outline-color-hover)"
                     stroke="url(#stop-button-outline-color-hover)"
                     stroke-width="4"
                  />
               </g>
            </svg>
         </div>
      </section>
      
      <!-- preview that dynamically responds to hover, active, etc. -->
      <section class="view active">
         <header>
            Interactive preview
         </header>
         <div class="layer vector">
            <button class="play-pause">Play</button>
         </div>
      </section>
      
      <!--
         Viewing options and controls, to aid in testing and 
         comparisons.
      -->
      <section class="utilities">
         <!-- Control the play/pause icon, and the button states. -->
         <div id="button-state-select">
            <label><input type="radio" name="button-state" value="normal" checked /> Normal</label>
            <label><input type="radio" name="button-state" value="active" /> Active</label>
            <label><input type="radio" name="button-state" value="hover" />  Hover</label>
            <label><input type="radio" name="button-state" value="disabled" />  Disabled</label>
         </div>
         <label>
            Play/Pause Icon:
            <select id="play-pause-icon-select">
               <option value="play">Play</option>
               <option value="pause">Pause</option>
            </select>
         </label>
         <br/>
         
         <!-- The view is half-raster/half-vector. Cotnrol at what 
         X-coordinate we switch from the one to the other. -->
         <label>Raster:</label> <input type="range" id="raster-threshold" min="0" max="364" value="0" />
         <br/>
         
         <!-- Disable alpha masks. It's easiest to try and match the 
         color of the raster first, and then try to match the alpha. -->
         <div>
            <label>
               Filter:
               <select id="filter-picker">
                  <option>None</option>
                  <option value="disable-alpha">Disable alpha</option>
                  <option value="show-alpha">Show alpha</option>
               </select>
            </label>
         </div>
      </section>
      
      <section class="utilities gradient-editor">
         <div class="source">
         </div>
         <svg>
            <defs>
               <linearGradient id="gradient-editor-svg-grad" />
            </defs>
            <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-editor-svg-grad)" />
         </svg>
         <pre>
         </pre>
      </section>
      <script src="index.js"></script>
   </body>
</html>